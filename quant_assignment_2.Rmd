---
title: "assignment_1"
author: "Rania Karamallah, MC Abbott, Alex Cardelle"
date: "10/20/2021"
output: 
  html_document"
    theme: readable
    toc: true
    toc_depth: 3
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Research Question

Do neighborhoods with higher walkability scores lead to reduced commuting via car?

# Prior Research

Riggs and Sethi (2020), in examining a quantified, indexed version of "walkability", have determined that neighborhoods scoring high in this category do show increased multimodal/alternative transportation use (namely -- walking, cycling, or transit). With more specificity, Watson et. al (2020) provide a national-level overview that confirms a strong link between high walkability scores and walking itself as a mode of commuting to work throughout the urban areas of the United States. Our research question seeks to confirm these findings through selected census tracts.

# Data

We will be using the following data sets:

* United States Environmental Projection Agency: Smart Location Mapping, National Walkability Index
* United States Census Data Means of Transportation for People with a Car
* Centers for Disease Control and Prevention: U.S. Chronic Disease Indicators: Mental Health 

# Variables for Analysis

* County (categorical)
* Block Group (categorical)
* Census Tract (categorical)
* Combined Statistical Area (categorical)
* Total Number of Workers in a Block Group (continuous)
* Percentage of Low Wage Earners (continuous)
* Walkability Score (continuous)

## Load data

```{r}
library(tidyverse)
library(tidycensus)
library(readxl)
library(knitr)
```

## Means of Transportation for People with a Car

```{r, message = FALSE, results = FALSE, warning = FALSE}

all_states <- c(state.abb)

acs_transport <- get_acs(geography = "tract", 
                        year = 2020,
                        variables = c(transport_any = "B08301_001",
                                      transport_walk = "B08301_019",
                                      transport_car = "B08301_002",
                                      transport_public = "B08301_010",
                                      transport_bike = "B08301_018",
                                      transport_taxi = "B08301_016",
                                      transport_motorcycle = "B08301_018",
                                      transport_other = "B08301_020"),
                        state = "MA",
                        county = "Suffolk",
                        output = "wide",
                        geometry = FALSE) %>%
  mutate(pct_walk = transport_walk / transport_any) %>%
  mutate(pct_car = transport_car / transport_any) %>%
  mutate(pct_public = transport_public / transport_any) %>%
  mutate(pct_bike = transport_bike / transport_any) %>%
  mutate(pct_taxi = transport_taxi / transport_any) %>%
  mutate(pct_motorcycle = transport_motorcycle / transport_any) %>%
  mutate(pct_other = transport_other / transport_any)%>%
  select(GEOID, pct_walk, pct_car, pct_public, pct_bike, pct_taxi, pct_motorcycle, pct_other)
  
```

## U.S. Chronic Disease Indicators: Mental Health 

From USCDC: Poor mental health interferes with social functioning, is associated with health behavior, and should be monitored as an overall indicator of chronic disease burden. Research has shown that poor mental health is a major source of distress, disability, and social burden.   Furthermore, poor mental health can interfere with social functioning and negatively impact physical well-being as well as the practice of health-promoting behaviors.


```{r}
Mental_Health <- read_csv('data/PLACES__Local_Data_for_Better_Health__Census_Tract_Data_2020_release.csv') %>%
  filter(Year == 2018) %>%
  filter(Short_Question_Text == "Mental Health") %>%
  rename(GEOID = LocationID) %>%
  group_by(GEOID) %>%
  rename(pct_mental = Data_Value) %>%
  select(GEOID, pct_mental, Data_Value_Unit)

Asthma <- read_csv('data/PLACES__Local_Data_for_Better_Health__Census_Tract_Data_2020_release.csv') %>%
  filter(Year == 2018) %>%
  filter(Short_Question_Text == "Asthma") %>%
  rename(GEOID = LocationID) %>%
  group_by(GEOID) %>%
  rename(pct_asthma = Data_Value) %>%
  select(GEOID, pct_asthma, Data_Value_Unit)

```

## Walkability

From USEPA: The National Walkability Index provides walkability scores based on a simple formula that ranks selected indicators from the Smart Location Database that have been demonstrated to affect the propensity of walk trips. Currently, the National Walkability Index dataset ranks each block group relative to all other block groups in the United States, but individuals can use downloadable data and the "how-to" document to construct an index for a smaller universe of block groups, like a state, metropolitan area, or city.

```{r}
Walkability <- read_csv("data/EPA_SmartLocationDatabase_V3_Jan_2021_Final.csv")  %>%

  Walkability <- read_csv("https://raw.githubusercontent.com/mcmcmca/quant_assignment_1/main/EPA_SmartLocationDatabase_V3_Jan_2021_Final.csv")  %>%

  filter(STATEFP == "25") %>%
  select(STATEFP, COUNTYFP, TRACTCE, BLKGRPCE, CSA, CSA_Name, CBSA, CBSA_Name, CBSA_POP, P_WrkAge, AutoOwn0, Workers, R_LowWageWk, R_MedWageWk, R_HiWageWk, R_PCTLOWWAGE, NatWalkInd)

```

## Assembling the datasets 

```{r, message = FALSE, warning = FALSE}
#data <- left_join(census, GEOID) %>% 
#  left_join(acs_transport) %>%

#kable(head(data))
```
